name: Caller workflow
on:
  workflow_dispatch:
    inputs:
      environment:
        description: "environment"
        type: environment
        required: true
jobs:
  init:
    runs-on: ubuntu-latest
    name: "my test"
    steps:
     - name: Set up environment variables
       run: |
          # Export SIZE_VAR as a single-line JSON string to preserve the content
          echo "export SIZE_VAR='${{ replace(vars.SIZE_VAR, '\n', '\\n') }}'" >> $GITHUB_ENV

          # Use a simple Bash script to extract the relevant data based on the current environment
          current_environment="${{ github.event.inputs.environment }}"
          relevant_data=$(echo "$SIZE_VAR" | jq -r ".[\"$current_environment\"]")

          # Export the relevant data as an environment variable
          echo "export RELEVANT_DATA='$relevant_data'" >> $GITHUB_ENV
          
     - name: Print relevant data
       run: |
          # Access the exported environment variable containing the relevant data
          echo "Current environment: ${{ github.event.inputs.environment }}"
          echo "Relevant data for the current environment: $RELEVANT_DATA"
